"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),React__default=_interopDefault(React),reactRouterDom=require("react-router-dom"),isUndefined=function(e){return void 0===e},isNull=function(e){return null===e},isFunction=function(e){return"function"==typeof e},isString=function(e){return"string"==typeof e},isExist=function(e){return!(isUndefined(e)||isNull(e))},get=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2];t=isString(t)?t.split("."):t;for(var r=void 0,c=e,o=0;o<t.length;o++){var a=t[o];if(!isExist(c))break;c=c[a]}return o===t.length&&(r=c),isUndefined(r)?n:r},run=function(e){for(var t=arguments.length,n=Array(2<t?t-2:0),r=2;r<t;r++)n[r-2]=arguments[r];var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];c=isString(c)?c.split("."):c;var o=get(e,c),a=get(e,c.slice(0,-1));return isFunction(o)?o.call.apply(o,[a].concat(n)):o},classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},objectWithoutProperties=function(e,t){var n={};for(var r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},CacheComponent=function(e){function i(e){var t;classCallCheck(this,i);for(var n=arguments.length,r=Array(1<n?n-1:0),c=1;c<n;c++)r[c-1]=arguments[c];var o=possibleConstructorReturn(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this,e].concat(r)));o.cacheLifecycles={__listener:{},didCache:function(e){o.cacheLifecycles.__listener.didCache=e},didRecover:function(e){o.cacheLifecycles.__listener.didRecover=e}};var a=!!e.match;return o.state={cached:a,matched:a},o}return inherits(i,e),createClass(i,[{key:"render",value:function(){return this.state.cached?React__default.createElement("div",{style:this.state.matched?{}:{display:"none"}},run(this.props,"children",this.cacheLifecycles)):null}}]),createClass(i,[{key:"componentDidUpdate",value:function(e,t){t.cached&&this.state.cached&&(!0===t.matched&&!1===this.state.matched&&run(this,"cacheLifecycles.__listener.didCache"),!1===t.matched&&!0===this.state.matched&&run(this,"cacheLifecycles.__listener.didRecover"))}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.matched||t.matched}}]),i}(React.Component);CacheComponent.getDerivedStateFromProps=function(e,t){return!t.cached&&e.match?{cached:!0,matched:!0}:t.matched&&"POP"===e.history.action&&!e.match?{cached:!1,matched:!1}:{matched:!!e.match}};var cacheComponent=function(n){return function(t){return React__default.createElement(CacheComponent,t,function(e){return React__default.createElement(n,_extends({},t,{cacheLifecycles:e}))})}},CacheRoute=function(e){var t=e.component,n=objectWithoutProperties(e,["component"]);return React__default.createElement(reactRouterDom.Route,_extends({},n,{children:cacheComponent(t)}))};exports.cacheComponent=cacheComponent,exports.default=CacheRoute;
